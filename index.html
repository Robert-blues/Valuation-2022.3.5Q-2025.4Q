<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>íˆ¬ìê¸ˆìœµíŒ€ í‰ê°€ ìì‚° Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body { margin:0; padding:0; height:100%; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    #map { position:absolute; top:0; left:0; right:300px; bottom:0; }
    #sidebar {
      position:absolute; top:0; right:0; bottom:0; width:300px;
      background:#fff; border-left:1px solid #ddd; box-shadow:-2px 0 4px rgba(0,0,0,0.05);
      padding:10px 12px; box-sizing:border-box; overflow-y:auto; font-size:13px;
    }
    #sidebar h2 { font-size:16px; margin:4px 0 10px 0; }
    #sidebar h3 { font-size:13px; margin:10px 0 6px 0; border-bottom:1px solid #eee; padding-bottom:4px; }
    .section { margin-bottom:10px; }
    .mini-help { font-size:11px; color:#666; margin:6px 0 0 0; line-height:1.35; }
    input[type="text"] {
      width:100%; box-sizing:border-box; padding:6px; font-size:12px;
      border:1px solid #ccc; border-radius:4px; margin-bottom:6px;
    }
    button {
      width:100%; padding:7px 8px; font-size:12px; cursor:pointer;
      border-radius:4px; border:1px solid #ccc; background:#f5f5f5;
    }
    button:hover { background:#e9e9e9; }
    .mini-btn-row { display:flex; gap:6px; margin-bottom:6px; }
    .mini-btn-row button { width:auto; flex:1; padding:5px; font-size:11px; }
    .list {
      border:1px solid #eee; background:#fafafa; border-radius:4px;
      padding:6px; max-height:180px; overflow-y:auto;
    }
    .item { display:flex; align-items:center; justify-content:space-between; gap:8px; margin:4px 0; }
    .left { display:flex; align-items:center; gap:6px; min-width:0; }
    .left span.label { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:165px; }
    .count { color:#555; font-size:11px; flex:0 0 auto; }
    .dot { width:10px; height:10px; border-radius:50%; border:1px solid rgba(0,0,0,0.35); flex:0 0 auto; }
    .toast {
      position:fixed; right:320px; bottom:18px;
      background:rgba(0,0,0,0.78); color:#fff;
      padding:10px 12px; border-radius:8px; font-size:12px;
      opacity:0; transform:translateY(6px);
      transition:opacity 0.18s ease, transform 0.18s ease;
      pointer-events:none; z-index:9999;
    }
    .toast.show { opacity:1; transform:translateY(0); }
    .iw-wrap { min-width:320px; max-width:460px; max-height:360px; overflow-y:auto; font-size:12px; line-height:1.35; }
    .iw-row { margin:2px 0; }
    .iw-row b { display:inline-block; min-width:150px; }
  </style>
</head>

<body>
  <div id="map"></div>

  <div id="sidebar">
    <h2>íˆ¬ìê¸ˆìœµíŒ€ í‰ê°€ ìì‚° Map</h2>

    <div class="section">
      <button id="reset-btn">ğŸ”„ í•„í„° ì´ˆê¸°í™” (ì „ì²´ ë³´ê¸°)</button>
    </div>

    <div class="section">
      <h3>ì§€ë²ˆ / ì£¼ì†Œ ê²€ìƒ‰</h3>
      <input id="search-input" type="text" placeholder="ì˜ˆ: ê²½ê¸°ë„ ì•ˆì‚°ì‹œ ìƒë¡êµ¬ ë³¸ì˜¤ë™ 730-2" />
      <button id="search-btn">í˜„ì¬ ì§€ë„ì—ì„œ ê²€ìƒ‰</button>
      <p class="mini-help">ì…ë ¥í•œ ì£¼ì†Œ/ì§€ë²ˆì„ ì§€ë„ì—ì„œ ì°¾ì•„ ë°˜ê²½(1km)ì„ í‘œì‹œí•˜ê³  í•´ë‹¹ ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
    </div>

    <div class="section">
      <h3>ì°¨ì£¼ëª… ê²€ìƒ‰</h3>
      <input id="borrower-input" type="text" placeholder="ì°¨ì£¼ëª… ì…ë ¥ (ë¶€ë¶„ê²€ìƒ‰)" />
      <button id="borrower-btn">ì°¨ì£¼ëª…ìœ¼ë¡œ í•„í„°</button>
      <p class="mini-help">ì°¨ì£¼ëª…ì— ì…ë ¥ê°’ì´ í¬í•¨ëœ ìì‚°ë§Œ í‘œì‹œí•©ë‹ˆë‹¤.</p>
    </div>

    <div class="section">
      <h3>Disco ì£¼ì†Œ ê²€ìƒ‰</h3>
      <input id="disco-input" type="text" placeholder="ì§€ë²ˆ ë˜ëŠ” ì£¼ì†Œ ì…ë ¥" />
      <button id="disco-btn">Discoì—ì„œ ê²€ìƒ‰í•˜ê¸° (ë³µì‚¬ + ìƒˆíƒ­)</button>
      <p class="mini-help">ë²„íŠ¼ í´ë¦­ ì‹œ ì…ë ¥ê°’ì´ ìë™ìœ¼ë¡œ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ê³ , disco.re ê²€ìƒ‰ì´ ìƒˆ íƒ­ì—ì„œ ì—´ë¦½ë‹ˆë‹¤.</p>
    </div>

    <div class="section">
      <h3>ìì‚°ìœ í˜• í•„í„°</h3>
      <input id="type-search" type="text" placeholder="ìì‚°ìœ í˜• ê²€ìƒ‰" />
      <div class="mini-btn-row">
        <button id="type-all">ì „ì²´</button>
        <button id="type-none">í•´ì œ</button>
      </div>
      <div id="type-list" class="list"></div>
    </div>

    <div class="section">
      <h3>Pool í•„í„°</h3>
      <input id="pool-search" type="text" placeholder="Pool ê²€ìƒ‰" />
      <div class="mini-btn-row">
        <button id="pool-all">ì „ì²´</button>
        <button id="pool-none">í•´ì œ</button>
      </div>
      <div id="pool-list" class="list"></div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    function toNumber(v) {
      if (v === null || v === undefined) return NaN;
      if (typeof v === "number") return v;
      const s = String(v).replace(/,/g, "").trim();
      if (s === "") return NaN;
      return Number(s);
    }

    function fmtComma(v) {
      const n = toNumber(v);
      if (Number.isNaN(n)) return (v === null || v === undefined) ? "" : String(v);
      return Math.round(n).toLocaleString("ko-KR");
    }

    function fmtIntegerComma(v) {
      const n = toNumber(v);
      if (Number.isNaN(n)) return (v === null || v === undefined) ? "" : String(v);
      return Math.trunc(n).toLocaleString("ko-KR");
    }

    function safeText(v) {
      if (v === null || v === undefined) return "";
      return String(v);
    }

    // âœ… í‚¤ê°€ ë‹¬ë¼ë„ ê°’ì„ ì°¾ì•„ì˜¤ëŠ” fallback
    function pickAny(asset, keys) {
      for (const k of keys) {
        if (Object.prototype.hasOwnProperty.call(asset, k) && asset[k] !== null && asset[k] !== undefined && String(asset[k]).trim() !== "") {
          return asset[k];
        }
      }
      return null;
    }

    // Pool ìƒ‰ìƒ/ì•„ì´ì½˜(ê¸°ë³¸ ë§ˆì»¤: ë¹ ë¦„)
    const POOL_ICON_NAMES = ["red","blue","green","purple","yellow","ltblue","orange","pink"];
    const POOL_CSS_COLORS = ["#e74c3c","#3498db","#2ecc71","#9b59b6","#f1c40f","#1abc9c","#e67e22","#fd79a8"];
    const poolIndexMap = {};

    function getPoolIndex(pool) {
      const key = pool || "ë¯¸ì§€ì •";
      if (poolIndexMap[key] !== undefined) return poolIndexMap[key];
      const idx = Object.keys(poolIndexMap).length % POOL_ICON_NAMES.length;
      poolIndexMap[key] = idx;
      return idx;
    }

    function getPoolIconUrl(pool) {
      const idx = getPoolIndex(pool);
      return "https://maps.google.com/mapfiles/ms/icons/" + POOL_ICON_NAMES[idx] + "-dot.png";
    }

    function getPoolCssColor(pool) {
      const idx = getPoolIndex(pool);
      return POOL_CSS_COLORS[idx];
    }

    let map, geocoder, searchCircle;
    let markers = [];
    let typeVisibility = {};
    let poolVisibility = {};
    let borrowerFilter = "";

    // âœ… í† ì§€ë©´ì (í‰) í‘œì‹œ: (í‰) ì»¬ëŸ¼ëª…ì´ ì˜¤íƒ€/ë³€í˜•ì´ì–´ë„ ì¡íˆê²Œ pick ì ìš©
    const INFO_FIELDS = [
      { key: "Pool", label: "Pool" },
      { key: "ëŒ€í‘œì§€ë²ˆ", label: "ëŒ€í‘œì§€ë²ˆ" },
      { key: "ëŒ€í‘œì§€ë²ˆ_ì •ì œ", label: "ëŒ€í‘œì§€ë²ˆ_ì •ì œ" },
      { key: "ì°¨ì£¼ëª…", label: "ì°¨ì£¼ëª…" },
      { key: "OPB", label: "OPB", fmt: "comma" },
      { key: "ë¬¼ê±´ë²ˆí˜¸", label: "ë¬¼ê±´ë²ˆí˜¸" },
      { key: "ì†Œì¬ì§€1", label: "ì†Œì¬ì§€1" },
      { key: "ì†Œì¬ì§€2", label: "ì†Œì¬ì§€2" },
      { key: "ì†Œì¬ì§€3", label: "ì†Œì¬ì§€3" },
      { key: "ì†Œì¬ì§€4", label: "ì†Œì¬ì§€4" },
      { key: "ìì‚°ìœ í˜•", label: "ìì‚°ìœ í˜•" },
      { key: "ê·¼ì €ë‹¹ì„¤ì •ìˆœìœ„", label: "ê·¼ì €ë‹¹ì„¤ì •ìˆœìœ„" },
      { key: "ê·¼ì €ë‹¹ê¶Œì„¤ì •ì•¡", label: "ê·¼ì €ë‹¹ê¶Œì„¤ì •ì•¡", fmt: "comma" },

      // âœ… ì—¬ê¸°! í† ì§€ë©´ì (í‰)ì´ ì•ˆ ëœ¨ë˜ ë¬¸ì œ í•´ê²°
      { key: "__land_area_pyeong", label: "í† ì§€ë©´ì (í‰)",
        pick: (a) => pickAny(a, ["í† ì§€ë©´ì (í‰)", "í† ì§€ë©´ì ¹(í‰)", "í† ì§€ë©´ì ", "í† ì§€ë©´ì ¹"]) },

      { key: "ê±´ë¬¼ë©´ì (í‰)", label: "ê±´ë¬¼ë©´ì (í‰)" },

      { key: "__land_appraisal", label: "ê°ì •í‰ê°€ì•¡_í† ì§€", fmt: "comma",
        pick: (a) => pickAny(a, ["ê°ì •í‰ê°€ì•¡_í† ì§€","ê°ì •í‰ê°€ì•¡-í† ì§€","ê°ì •í‰ê°€ì•¡-ëŒ€ì§€","í† ì§€","ê°ì •í‰ê°€ì•¡-ëŒ€ì§€(í† ì§€)"]) },

      { key: "__bldg_appraisal", label: "ê°ì •í‰ê°€ì•¡_ê±´ë¬¼", fmt: "comma",
        pick: (a) => pickAny(a, ["ê°ì •í‰ê°€ì•¡_ê±´ë¬¼","ê°ì •í‰ê°€ì•¡-ê±´ë¬¼","ê±´ë¬¼"]) },

      { key: "__mach_appraisal", label: "ê°ì •í‰ê°€ì•¡_ê¸°ê³„ê¸°êµ¬", fmt: "comma",
        pick: (a) => pickAny(a, ["ê°ì •í‰ê°€ì•¡_ê¸°ê³„ê¸°êµ¬","ê°ì •í‰ê°€ì•¡-ê¸°ê³„ê¸°êµ¬","ê¸°ê³„ê¸°êµ¬"]) },

      { key: "__extra_appraisal", label: "ê°ì •í‰ê°€ì•¡_ì œì‹œì™¸", fmt: "comma",
        pick: (a) => pickAny(a, ["ê°ì •í‰ê°€ì•¡_ì œì‹œì™¸","ê°ì •í‰ê°€ì•¡-ì œì‹œì™¸","ì œì‹œì™¸"]) },

      { key: "í•©ê³„", label: "ê°ì •í‰ê°€ì•¡ í•©ê³„", fmt: "comma" },
      { key: "1ì•ˆ í‰ë‹¹ê°€ì•¡(í† ì§€+ê±´ë¬¼)", label: "1ì•ˆ í‰ë‹¹ê°€ì•¡(í† ì§€+ê±´ë¬¼)", fmt: "comma" },
      { key: "2ì•ˆ í‰ë‹¹ê°€ì•¡(í† ì§€+ê±´ë¬¼)", label: "2ì•ˆ í‰ë‹¹ê°€ì•¡(í† ì§€+ê±´ë¬¼)", fmt: "comma" },
      { key: "ê´€í• ë²•ì›", label: "ê´€í• ë²•ì›" },
      { key: "ê²½ë§¤ì‚¬ê±´ë²ˆí˜¸(ì„ í–‰ê¸°ì¤€)", label: "ê²½ë§¤ì‚¬ê±´ë²ˆí˜¸(ì„ í–‰ê¸°ì¤€)" },
      { key: "íšŒì°¨ ë° ê²°ê³¼", label: "íšŒì°¨ ë° ê²°ê³¼" },
      { key: "ë‚™ì°°/ë§¤ë§¤ê¸ˆì•¡", label: "ë‚™ì°°/ë§¤ë§¤ê¸ˆì•¡", fmt: "comma" },
      { key: "ë‚™ì°°/ë§¤ë§¤ê¸ˆì•¡ í‰ë‹¹ê°€", label: "ë‚™ì°°/ë§¤ë§¤ê¸ˆì•¡ í‰ë‹¹ê°€", fmt: "intcomma" },
      { key: "ë¹„ê³ ", label: "ë¹„ê³ " },
      { key: "íšŒìƒë²•ì›", label: "íšŒìƒë²•ì›" },
      { key: "íšŒìƒì‚¬ê±´ë²ˆí˜¸", label: "íšŒìƒì‚¬ê±´ë²ˆí˜¸" },
      { key: "íšŒìƒì§„í–‰ìƒí™©", label: "íšŒìƒì§„í–‰ìƒí™©" }
    ];

    function buildInfoHtml(asset) {
      let rows = "";
      for (const f of INFO_FIELDS) {
        let v = (typeof f.pick === "function") ? f.pick(asset) : asset[f.key];

        if (f.fmt === "comma") v = fmtComma(v);
        else if (f.fmt === "intcomma") v = fmtIntegerComma(v);
        else v = safeText(v);

        rows += `<div class="iw-row"><b>${f.label}:</b> ${v}</div>`;
      }
      return `<div class="iw-wrap">${rows}</div>`;
    }

    async function loadAssets() {
      const res = await fetch("data/assets.json", { cache: "no-store" });
      if (!res.ok) throw new Error("assets.json ë¡œë“œ ì‹¤íŒ¨: " + res.status);
      return await res.json();
    }

    function updateMarkerVisibility() {
      const q = (borrowerFilter || "").toLowerCase();
      for (const obj of markers) {
        const matchType = (typeVisibility[obj.typeKey] !== false);
        const matchPool = (poolVisibility[obj.poolKey] !== false);

        let matchBorrower = true;
        if (q) {
          const b = (obj.borrowerName || "").toLowerCase();
          matchBorrower = b.includes(q);
        }
        obj.marker.setVisible(matchType && matchPool && matchBorrower);
      }
    }

    function fitMapToVisibleMarkers() {
      const bounds = new google.maps.LatLngBounds();
      let any = false;
      for (const obj of markers) {
        if (obj.marker.getVisible()) {
          bounds.extend(obj.marker.getPosition());
          any = true;
        }
      }
      if (any) map.fitBounds(bounds);
    }

    function renderFilterList(containerId, counts, visibilityMap, colorFn, dataAttrName) {
      const el = document.getElementById(containerId);
      el.innerHTML = "";
      const entries = Object.entries(counts).sort((a, b) => b[1] - a[1]);

      for (const [key, count] of entries) {
        const row = document.createElement("div");
        row.className = "item";

        const left = document.createElement("div");
        left.className = "left";

        const box = document.createElement("input");
        box.type = "checkbox";
        box.checked = true;
        box.setAttribute(dataAttrName, key);

        const dot = document.createElement("span");
        dot.className = "dot";
        dot.style.backgroundColor = colorFn ? colorFn(key) : "#888";

        const label = document.createElement("span");
        label.className = "label";
        label.textContent = key;

        left.appendChild(box);
        left.appendChild(dot);
        left.appendChild(label);

        const right = document.createElement("span");
        right.className = "count";
        right.textContent = count + "ê±´";

        row.appendChild(left);
        row.appendChild(right);
        el.appendChild(row);

        box.addEventListener("change", function() {
          const k = this.getAttribute(dataAttrName);
          visibilityMap[k] = this.checked;
          updateMarkerVisibility();
          fitMapToVisibleMarkers();
        });
      }
    }

    function setupListSearch(inputId, listId) {
      const input = document.getElementById(inputId);
      const list = document.getElementById(listId);
      if (!input || !list) return;

      input.addEventListener("keyup", function() {
        const q = (this.value || "").toLowerCase();
        const rows = list.children;
        for (let i = 0; i < rows.length; i++) {
          const row = rows[i];
          const label = row.querySelector(".label");
          const text = label ? label.textContent.toLowerCase() : "";
          row.style.display = text.includes(q) ? "" : "none";
        }
      });
    }

    function setAllChecksByDataAttr(listId, dataAttrName, visibilityMap, checked) {
      const list = document.getElementById(listId);
      const boxes = list.querySelectorAll(`input[${dataAttrName}]`);
      for (const box of boxes) {
        const key = box.getAttribute(dataAttrName);
        box.checked = checked;
        visibilityMap[key] = checked;
      }
      updateMarkerVisibility();
      fitMapToVisibleMarkers();
    }

    function showToast(msg) {
      const el = document.getElementById("toast");
      el.textContent = msg;
      el.classList.add("show");
      setTimeout(() => el.classList.remove("show"), 1500);
    }

    function setupSearchBox() {
      const input = document.getElementById("search-input");
      const btn = document.getElementById("search-btn");
      if (!input || !btn) return;

      function doSearch() {
        const q = (input.value || "").trim();
        if (!q) return;

        geocoder.geocode({ address: q, region: "kr" }, (results, status) => {
          if (status === "OK" && results && results.length) {
            const loc = results[0].geometry.location;
            if (searchCircle) searchCircle.setMap(null);
            searchCircle = new google.maps.Circle({
              map,
              center: loc,
              radius: 1000,
              fillColor: "#4285F4",
              fillOpacity: 0.15,
              strokeColor: "#4285F4",
              strokeOpacity: 0.85,
              strokeWeight: 1
            });
            map.fitBounds(searchCircle.getBounds());
          } else {
            alert("í•´ë‹¹ ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: " + status);
          }
        });
      }

      btn.addEventListener("click", doSearch);
      input.addEventListener("keyup", (e) => { if (e.key === "Enter") doSearch(); });
    }

    function setupBorrowerBox() {
      const input = document.getElementById("borrower-input");
      const btn = document.getElementById("borrower-btn");
      if (!input || !btn) return;

      function apply() {
        borrowerFilter = (input.value || "").trim();
        updateMarkerVisibility();
        fitMapToVisibleMarkers();
      }

      btn.addEventListener("click", apply);
      input.addEventListener("keyup", (e) => { if (e.key === "Enter") apply(); });
    }

    function setupDiscoSearchBox() {
      const input = document.getElementById("disco-input");
      const btn = document.getElementById("disco-btn");
      if (!input || !btn) return;

      async function goDisco() {
        const q = (input.value || "").trim();
        if (!q) {
          alert("ê²€ìƒ‰í•  ì§€ë²ˆ ë˜ëŠ” ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
          return;
        }
        try {
          await navigator.clipboard.writeText(q);
          showToast("í´ë¦½ë³´ë“œ ë³µì‚¬ ì™„ë£Œ âœ…");
        } catch (e) {
          alert("í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ë¸Œë¼ìš°ì € ê¶Œí•œ/HTTPS í™•ì¸)\n\nê·¸ë˜ë„ Disco ê²€ìƒ‰ì€ ìƒˆ íƒ­ì—ì„œ ì—´ë¦½ë‹ˆë‹¤.");
        }
        const url = "https://disco.re/search?keyword=" + encodeURIComponent(q);
        window.open(url, "_blank");
      }

      btn.addEventListener("click", goDisco);
      input.addEventListener("keyup", (e) => { if (e.key === "Enter") goDisco(); });
    }

    function setupResetButton() {
      const btn = document.getElementById("reset-btn");
      if (!btn) return;

      btn.addEventListener("click", () => {
        borrowerFilter = "";
        Object.keys(typeVisibility).forEach(k => typeVisibility[k] = true);
        Object.keys(poolVisibility).forEach(k => poolVisibility[k] = true);
        document.querySelectorAll('input[data-type], input[data-pool]').forEach(b => b.checked = true);

        ["type-search","pool-search","search-input","borrower-input","disco-input"].forEach(id => {
          const el = document.getElementById(id);
          if (el) el.value = "";
        });

        ["type-list","pool-list"].forEach(id => {
          const list = document.getElementById(id);
          if (!list) return;
          for (const row of list.children) row.style.display = "";
        });

        if (searchCircle) { searchCircle.setMap(null); searchCircle = null; }

        updateMarkerVisibility();
        fitMapToVisibleMarkers();
      });
    }

    async function initMap() {
      const assets = await loadAssets();

      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 7,
        center: { lat: 36.5, lng: 127.8 },
        clickableIcons: false
      });

      geocoder = new google.maps.Geocoder();

      const bounds = new google.maps.LatLngBounds();
      const typeCounts = {};
      const poolCounts = {};

      for (const asset of assets) {
        const lat = Number(asset.lat);
        const lng = Number(asset.lng);
        if (!Number.isFinite(lat) || !Number.isFinite(lng)) continue;

        const typeKey = asset["ìì‚°ìœ í˜•"] || "ê¸°íƒ€";
        const poolKey = asset["Pool"] || "ë¯¸ì§€ì •";
        const borrowerName = asset["ì°¨ì£¼ëª…"] || "";

        if (!typeCounts[typeKey]) { typeCounts[typeKey] = 0; typeVisibility[typeKey] = true; }
        if (!poolCounts[poolKey]) { poolCounts[poolKey] = 0; poolVisibility[poolKey] = true; }

        typeCounts[typeKey] += 1;
        poolCounts[poolKey] += 1;

        const marker = new google.maps.Marker({
          position: { lat, lng },
          map,
          icon: getPoolIconUrl(poolKey),
          title: asset["ëŒ€í‘œì§€ë²ˆ_ì •ì œ"] || asset["ëŒ€í‘œì§€ë²ˆ"] || ""
        });

        const iw = new google.maps.InfoWindow({ content: buildInfoHtml(asset) });
        marker.addListener("click", () => iw.open(map, marker));

        markers.push({ marker, typeKey, poolKey, borrowerName });
        bounds.extend(marker.getPosition());
      }

      if (!bounds.isEmpty()) map.fitBounds(bounds);

      renderFilterList("type-list", typeCounts, typeVisibility, () => "#888", "data-type");
      renderFilterList("pool-list", poolCounts, poolVisibility, getPoolCssColor, "data-pool");

      setupListSearch("type-search", "type-list");
      setupListSearch("pool-search", "pool-list");

      document.getElementById("type-all").addEventListener("click", () => setAllChecksByDataAttr("type-list", "data-type", typeVisibility, true));
      document.getElementById("type-none").addEventListener("click", () => setAllChecksByDataAttr("type-list", "data-type", typeVisibility, false));
      document.getElementById("pool-all").addEventListener("click", () => setAllChecksByDataAttr("pool-list", "data-pool", poolVisibility, true));
      document.getElementById("pool-none").addEventListener("click", () => setAllChecksByDataAttr("pool-list", "data-pool", poolVisibility, false));

      setupSearchBox();
      setupBorrowerBox();
      setupDiscoSearchBox();
      setupResetButton();
    }
  </script>

  <script
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_JS_API_KEY&callback=initMap"
    async
    defer
  ></script>
</body>
</html>
